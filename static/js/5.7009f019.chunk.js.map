{"version":3,"sources":["hooks/title.ts","helpers/payload.ts","helpers/time.ts","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","hooks/dimensions.ts","components/Seekbar/index.tsx","components/Player/index.tsx","components/Compilation/index.tsx"],"names":["useTitle","title","opts","useEffect","document","replace","hyphen","decode","encodedPayload","JSON","parse","atob","replacer","_","val","toFixed","Number","encode","payloadObj","btoa","stringify","formatDuration","memoize","length","Error","forceMinutes","Math","floor","toString","padStart","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","target","i","arguments","source","forEach","getOwnPropertyDescriptors","defineProperties","useDimensions","ref","useRef","useState","dimensions","setDimensions","resizeObserver","useMemo","ResizeObserver","entry","contentRect","toJSON","scrollWidth","current","useLayoutEffect","observe","unobserve","Seekbar","props","seekbar","zoomed","lefts","setLefts","seekbarRef","seekbarDimensions","zoomedRef","zoomedDimensions","onHover","x","seekbarLength","width","cappedValue","max","min","className","clips","map","clip","isActive","currentClip","video","videoID","clipID","style","flexGrow","left","progress","bounds","onMouseMove","e","rect","getBoundingClientRect","clientX","onTouchMove","touches","index","onClick","onClipChange","Player","playlist","setProgress","playerRef","setCurrentClip","ready","setReady","useCallback","request","onProgress","playedSeconds","getInternalPlayer","pauseVideo","seekTo","playing","url","progressInterval","light","height","config","youtube","playerVars","autoplay","modestbranding","start","end","Compilation","encodedData","useParams","data","payload","entries","flatMap","reduce","a","b","author"],"mappings":"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","file":"static/js/5.7009f019.chunk.js","sourcesContent":["import { useEffect } from \"react\";\r\n\r\ninterface TitleHookOpts {\r\n  hyphen?: boolean;\r\n  replace?: boolean;\r\n}\r\n\r\nexport default function useTitle(title?: string, opts: TitleHookOpts = {}) {\r\n  useEffect(() => {\r\n    document.title = !!title\r\n      ? (opts.replace ? \"\" : \"Bestoff \" + (opts.hyphen ? \"- \" : \"\")) + title\r\n      : \"Bestoff\";\r\n  }, [title, opts.hyphen, opts.replace]);\r\n}\r\n","import { ICompilation } from \"types\";\n\nexport function decode(encodedPayload: string): ICompilation {\n  return JSON.parse(atob(encodedPayload.replace(/_/g, \"/\").replace(/-/g, \"+\")));\n}\n\nconst replacer = (_: any, val: any) => {\n  return val.toFixed ? Number(val.toFixed(3)) : val;\n};\n\nexport function encode(payloadObj: object): string {\n  return btoa(JSON.stringify(payloadObj, replacer))\n    .replace(/\\//g, \"_\")\n    .replace(/\\+/g, \"-\");\n}\n","import { memoize } from \"lodash\";\r\n\r\ninterface FormatDurationOpts {\r\n  forceMinutes?: boolean;\r\n}\r\n\r\nexport const formatDuration = memoize(function formatDuration(\r\n  length: number,\r\n  opts: FormatDurationOpts = {}\r\n): string {\r\n  if (length < 0) {\r\n    throw new Error(\"Negative number are not supported\");\r\n  }\r\n\r\n  if (length < 60 && !opts.forceMinutes) {\r\n    return Math.floor(length).toString().padStart(2, \"0\") + \"s\";\r\n  }\r\n\r\n  if (length < 3600) {\r\n    return (\r\n      Math.floor(length / 60)\r\n        .toString()\r\n        .padStart(2, \"0\") +\r\n      \"m\" +\r\n      formatDuration(length % 60)\r\n    );\r\n  }\r\n\r\n  return (\r\n    Math.floor(length / 3600) +\r\n    \"h\" +\r\n    formatDuration(length % 3600, { forceMinutes: true })\r\n  );\r\n});\r\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"./defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","import {\n  useRef,\n  useState,\n  MutableRefObject,\n  useLayoutEffect,\n  useMemo,\n} from \"react\";\n\ntype ExtendedDOMRect = DOMRectReadOnly & { scrollWidth?: number };\n\nexport default function useDimensions<T extends HTMLElement>(): [\n  MutableRefObject<any>,\n  ExtendedDOMRect | null\n] {\n  const ref = useRef<T>(null);\n  const [dimensions, setDimensions] = useState<ExtendedDOMRect | null>(null);\n\n  const resizeObserver = useMemo(\n    () =>\n      new ResizeObserver(([entry]) =>\n        setDimensions({\n          ...entry.contentRect.toJSON(),\n          scrollWidth: ref.current?.scrollWidth,\n        })\n      ),\n    [setDimensions]\n  );\n\n  useLayoutEffect(() => {\n    const current = ref.current; // enclose current so the reference can be used in the unsubscribe\n    if (current) {\n      resizeObserver.observe(current);\n      return () => resizeObserver.unobserve(current);\n    }\n\n    return undefined;\n  }, [resizeObserver]);\n\n  return [ref, dimensions];\n}\n","import React, { useState } from \"react\";\nimport { IClip, ISelectedClip } from \"types\";\nimport useDimensions from \"hooks/dimensions\";\nimport \"./style.css\";\n\ninterface SeekbarProps {\n  clips: Array<IClip>;\n  currentClip: ISelectedClip;\n  onClipChange: (clip: ISelectedClip) => unknown;\n  progress: number;\n}\n\nexport default function Seekbar(props: SeekbarProps) {\n  const [lefts, setLefts] = useState<{ seekbar: number; zoomed: number }>({\n    seekbar: 0,\n    zoomed: 0,\n  });\n  const [seekbarRef, seekbarDimensions] = useDimensions();\n  const [zoomedRef, zoomedDimensions] = useDimensions();\n\n  const onHover = (x: number) => {\n    if (\n      !seekbarDimensions ||\n      !zoomedDimensions ||\n      !zoomedDimensions.scrollWidth\n    ) {\n      setLefts({ seekbar: 0, zoomed: 0 });\n      return;\n    }\n    const seekbarLength =\n      seekbarDimensions.width / zoomedDimensions.scrollWidth;\n    const value = x / seekbarDimensions.width - seekbarLength / 2;\n    const cappedValue = Math.max(0, Math.min(1 - seekbarLength, value));\n    setLefts({ seekbar: cappedValue, zoomed: value });\n  };\n\n  const onMouseMove = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    const rect = (e.target as HTMLDivElement).getBoundingClientRect();\n    const x = e.clientX - rect.left;\n\n    onHover(x);\n  };\n\n  const onTouchMove = (e: React.TouchEvent<HTMLDivElement>) => {\n    const rect = (e.touches[0]\n      .target as HTMLDivElement).getBoundingClientRect();\n    const x = e.touches[0].clientX - rect.left;\n\n    onHover(x);\n  };\n\n  return (\n    <div className=\"Seekbar\" ref={seekbarRef}>\n      <div className=\"Seekbar--main-wrapper\">\n        <div className=\"Seekbar--main\">\n          {props.clips.map((clip) => {\n            const isActive =\n              props.currentClip.video === clip.videoID &&\n              props.currentClip.clip === clip.clipID;\n            return (\n              <div\n                key={clip.videoID + \"_\" + clip.clipID}\n                className={\n                  \"Seekbar--clip\" + (isActive ? \" Seekbar--clip-active\" : \"\")\n                }\n                style={{ flexGrow: clip.length }}\n              >\n                {isActive && (\n                  <div\n                    style={{\n                      left:\n                        Math.min(\n                          1,\n                          Math.max(\n                            0,\n                            (props.progress - clip.bounds[0]) / clip.length\n                          )\n                        ) *\n                          100 +\n                        \"%\",\n                    }}\n                  />\n                )}\n              </div>\n            );\n          })}\n        </div>\n        <div\n          className=\"Seekbar--move\"\n          onMouseMove={onMouseMove}\n          onTouchMove={onTouchMove}\n        />\n        <div className=\"Seekbar--hover\">\n          <div\n            style={{\n              left: lefts.seekbar * 100 + \"%\",\n              width:\n                seekbarDimensions && zoomedDimensions?.scrollWidth\n                  ? (seekbarDimensions.width / zoomedDimensions.scrollWidth) *\n                      100 +\n                    \"%\"\n                  : \"10%\",\n            }}\n          />\n        </div>\n      </div>\n      <div className=\"Seekbar--zoomed\">\n        <div>\n          <div\n            className=\"Seekbar--zoomed-inner\"\n            style={{\n              left:\n                seekbarDimensions && zoomedDimensions?.scrollWidth\n                  ? -lefts.zoomed *\n                      (zoomedDimensions.scrollWidth / seekbarDimensions.width) *\n                      100 +\n                    \"%\"\n                  : \"0%\",\n            }}\n            ref={zoomedRef}\n          >\n            {props.clips.map((clip, index) => (\n              <div\n                key={clip.videoID + \"_\" + clip.clipID}\n                className={\n                  \"Seekbar--zoomed-clip\" +\n                  (props.currentClip.video === clip.videoID &&\n                  props.currentClip.clip === clip.clipID\n                    ? \" Seekbar--zoomed-clip-active\"\n                    : \"\")\n                }\n                style={{ width: clip.length * 3 + \"px\" }}\n                onClick={() =>\n                  props.onClipChange({ video: clip.videoID, clip: clip.clipID })\n                }\n              >\n                <div>#{index + 1}</div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, { useState, useCallback, useRef } from \"react\";\nimport ReactPlayer from \"react-player\";\nimport { IClip, IPlaylist, ISelectedClip, Entries } from \"types\";\nimport Seekbar from \"components/Seekbar\";\nimport \"./style.css\";\n\ninterface PlayerProps {\n  playlist: Entries<IPlaylist>;\n  clips: Array<IClip>;\n}\n\nexport function Player(props: PlayerProps) {\n  const { playlist, clips } = props;\n  const [progress, setProgress] = useState<number>(0);\n  const playerRef = useRef<ReactPlayer>(null);\n  const [currentClip, setCurrentClip] = useState<ISelectedClip>({\n    video: 0,\n    clip: 0,\n  });\n  const [ready, setReady] = useState<boolean>(false);\n\n  const onClipChange = useCallback(\n    (request: ISelectedClip) => {\n      setCurrentClip(request);\n      setReady(false);\n    },\n    [setCurrentClip, setReady]\n  );\n\n  const onProgress = useCallback(\n    ({ playedSeconds }: { playedSeconds: number }) => {\n      setProgress(playedSeconds);\n\n      if (!ready) {\n        if (\n          playedSeconds >=\n            playlist[currentClip.video][1][currentClip.clip][0] &&\n          playedSeconds < playlist[currentClip.video][1][currentClip.clip][1]\n        ) {\n          setReady(true);\n        } else {\n          playerRef.current?.seekTo(\n            playlist[currentClip.video][1][currentClip.clip][0]\n          );\n        }\n        return;\n      }\n\n      if (\n        !ready ||\n        playedSeconds < playlist[currentClip.video][1][currentClip.clip][1]\n      )\n        return;\n\n      if (currentClip.clip + 1 >= playlist[currentClip.video][1].length) {\n        if (currentClip.video + 1 >= playlist.length) {\n          (playerRef.current?.getInternalPlayer() as any)?.pauseVideo();\n          return;\n        }\n\n        setCurrentClip({ video: currentClip.video + 1, clip: 0 });\n        setReady(false);\n        return;\n      }\n\n      setCurrentClip({ ...currentClip, clip: currentClip.clip + 1 });\n      setReady(false);\n    },\n    [setProgress, ready, setReady, currentClip, playlist]\n  );\n\n  return (\n    <div className=\"Player\">\n      <div className=\"Player--embed\">\n        <ReactPlayer\n          ref={playerRef}\n          playing={true}\n          url={\"https://youtube.com/watch?v=\" + playlist[currentClip.video][0]}\n          progressInterval={16}\n          onProgress={onProgress}\n          light={true}\n          width={\"100%\"}\n          height={\"100%\"}\n          config={{\n            youtube: {\n              playerVars: {\n                autoplay: 1,\n                modestbranding: 1,\n                start: playlist[currentClip.video][1][currentClip.clip][0],\n                end: playlist[currentClip.video][1][currentClip.clip][1],\n              },\n            },\n          }}\n        />\n      </div>\n\n      <div className=\"Player--seekbar\">\n        <Seekbar\n          clips={clips}\n          currentClip={currentClip}\n          onClipChange={onClipChange}\n          progress={progress}\n        />\n      </div>\n    </div>\n  );\n}\n","import React, { useMemo } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { ICompilation, IClip } from \"types\";\nimport { formatDuration } from \"helpers/time\";\nimport { decode } from \"helpers/payload\";\nimport useTitle from \"hooks/title\";\nimport { Player } from \"components/Player\";\nimport \"./style.css\";\n\ninterface CompilationParams {\n  data: string;\n}\n\nexport default function Compilation() {\n  const { data: encodedData } = useParams<CompilationParams>();\n\n  const payload: ICompilation = useMemo(() => decode(encodedData), [\n    encodedData,\n  ]);\n\n  useTitle(payload.data.title, { hyphen: true });\n\n  const playlist = useMemo(() => Object.entries(payload.data.playlist), [\n    payload,\n  ]);\n\n  const clips: Array<IClip> = useMemo(\n    () =>\n      playlist.flatMap(([, clips], videoID) =>\n        clips.map((bounds, clipID) => ({\n          videoID,\n          clipID,\n          bounds,\n          length: bounds[1] - bounds[0],\n        }))\n      ),\n    [playlist]\n  );\n\n  const length: number = useMemo(\n    () => clips.map((clip) => clip.length).reduce((a, b) => a + b),\n    [clips]\n  );\n\n  return (\n    <div className=\"Compilation global--wrapper\">\n      <h2>{payload.data.title}</h2>\n\n      <p>\n        <span>{formatDuration(length)}</span> long compilation with{\" \"}\n        <span>{clips.length} clips</span> across{\" \"}\n        <span>{playlist.length} videos</span> by{\" \"}\n        <span>{payload.data.author}</span>\n      </p>\n\n      <Player playlist={playlist} clips={clips} />\n    </div>\n  );\n}\n"],"sourceRoot":""}